{{ define "title" }}
<!-- This will override the default value set in baseof.html; i.e., "{{.Site.Title}}" in the original example-->
{{ .Title }} â€“ {{ .Site.Title }}
{{ end }}
{{ define "main" }}
<div class="page comic container">
	<div class="comic-nav_top">
		{{ partial "comic-nav.html" . }}
	</div>
	<header class="comic__header">
		<h1 class="comic__title">{{ .Title }}</h1>
	</header>

	{{ if or (isset .Params "comic_mobile") (isset .Params "comic_desktop")}}
		<picture class="comic__whole">
			<!-- TODO: Add Image processing to this for 1x, 2x, etc-->
			{{ if (isset .Params "comic_mobile") }}
				<source media="(man-width: 767px)" srcset="{{ .Params.comic_mobile }}">
			{{ end }}
			{{ if (isset .Params "comic_desktop") }}
				<source media="(min-width: 768px)" srcset="{{ .Params.comic_desktop }}">
			{{ end }}
			<img src="{{ if (isset .Params "comic_mobile") }}{{ .Params.comic_mobile }}{{else}}{{ .Params.comic_desktop }}{{ end}}" alt="Comic for {{ .Title }}">
		</picture>
	{{ else }}
		{{ range .Params.comic.rows }}
			<div class="comic__row">
				{{ range .cols}}
					<div class="comic__panel">
						<img src="{{ .panel }}" class="comic__img" />
					</div>
				{{end}}
			</div>
		{{ end }}
	{{ end }}

	<div class="comic__content">
		{{ .Content }}
		<strong>Characters</strong>
		<ul class="list-unstyled">
		{{ range .Params.characters }}
				<li><a href="/characters/{{ . | urlize }}">{{ . }}</a></li>
		{{ end }}
		</ul>
	</div>
</div>

<script >
		if (/Mobi|Android/i.test(navigator.userAgent)) {
			window.onscroll = function() {
					if ((window.innerHeight + window.pageYOffset) >= document.body.offsetHeight) {
							document.getElementsByClassName('next')[0].click();
					}
			};
		} else {
			document.addEventListener('keydown', (event) => {
				const keyName = event.key;
				switch (keyName) {
					case "ArrowLeft":
						document.getElementsByClassName('prev')[0].click();
						return;
					case "ArrowRight":
						document.getElementsByClassName('next')[0].click();
						return;
					default:
						return;
				}
			});
		}
		</script>

{{end}}
